### This code is associated with the paper from Ferrin et al., "Kinetic modeling predicts a stimulatory role for ribosome collisions at elongation stall sites in bacteria". eLife, 2017. http://dx.doi.org/10.7554/eLife.23629


# Code for Ferrin elife 2017 paper

This repository includes raw data and code for running simulations, analyzing data, and reproducing figures in the paper.

Raw data from experiments and simulations are in [rawdata](rawdata) folder.

Individual scripts and [Jupyter Notebooks](http://jupyter.org/) are in [scripts](scripts) folder.

Final figures generated by running the analysis are in [figures](figures) folder.

[External annotations](#external-annotations) used for simulations are in [annotations](annotations) folder.

## Table of Contents
- [Example Workflow](#example-workflow)
- [Sample Output](#sample-output)
- [External Annotations](#external-annotations)
- [Machine Specifications](#machine-specifications)

## Example Workflow

```bash
# download data and scripts
git clone https://github.com/rasilab/ferrin_elife_2017.git

# download genome and annotations
cd ferrin_elife_2017
cd annotations/simulations
wget ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/005/845/GCA_000005845.2_ASM584v2/GCA_000005845.2_ASM584v2_genomic.fna.gz
gunzip GCA_000005845.2_ASM584v2_genomic.fna.gz -c > NC_000913.fna
wget ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/005/845/GCA_000005845.2_ASM584v2/GCA_000005845.2_ASM584v2_genomic.gff.gz
gunzip GCA_000005845.2_ASM584v2_genomic.gff.gz -c > NC_000913.gff
cd ../../

# install a python virtual environment for installing packages (optional)
# activate environment and upgrade the package installer
virtualenv py2
source py2/bin/activate
pip install pip --upgrade

# install python packages
pip install -r python_requirements.txt

# run analysis
cd scripts
sh masterscript.sh
```

To run simulations from scratch, uncomment the two lines highlighted in [scripts/masterscript.sh](scripts/masterscript.sh).

To use fresh simulation data for analysis, uncomment the lines indicated in [scripts/fit_simulation_to_experiment.ipynb](scripts/fit_simulation_to_experiment.ipynb) and [scripts/plot_simulation_results_figs_3_to_7.ipynb](scripts/plot_simulation_results_figs_3_to_7.ipynb).

## Example Output

```bash
> sh masterscript.sh
Tue Mar  7 21:13:41 PST 2017
Compiled whole cell simulation successfully.
Tue Mar  7 21:13:42 PST 2017
Compiled reporter simulation successfully.
Tue Mar  7 21:13:42 PST 2017
Made directories for storing generated data and figures.
Tue Mar  7 21:13:49 PST 2017
Plotted Fig 1 fluorescence data.
Tue Mar  7 21:13:56 PST 2017
Plotted Fig 1 polysome qPCR data.
Tue Mar  7 21:14:02 PST 2017
Plotted Fig 1 mRNA qPCR data.
Tue Mar  7 21:14:24 PST 2017
Analyzed all plate reader data.
Tue Mar  7 21:14:28 PST 2017
Fitted simulation results to experimental data.
Tue Mar  7 21:14:37 PST 2017
Created input files for simulations based on experimental fits.
Tue Mar  7 21:14:52 PST 2017
Plotting simulation results and comparison to experiments.
```
This will generate all the plots in the [figures](figures) folder.

## External Annotations

[annotations/simulations/yfp0.fa](annotations/simulations/yfp0.fa) is the base *yfp* sequence used for all simulations and experiments, and is from [Subramaniam et al. PNAS 2013](https://www.ncbi.nlm.nih.gov/pubmed/23277573/).

[annotations/simulations/ecoli.mrna.concn.and.te.li.2014.csv](annotations/simulations/ecoli.mrna.concn.and.te.li.2014.csv) was downloaded from [Li et al. Cell 2014](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4006352/), Table S4, opened in Libreoffice Calc and saved as csv file.

[annotations/simulations/ecoli.trna.abundance.dong1996.txt](annotations/simulations/ecoli.trna.abundance.dong1996.txt) was downloaded from [Dong et al. J. Mol. Biol. 1996](https://www.ncbi.nlm.nih.gov/pubmed/8709146), Table 2, and pasted into a text file. Gly1 and Ile2 entries were manually deleted from the table since these were not measured in this study. Sec tRNA was deleted since we are not considering this non-canonical translation. A typo for Val1 anticodon was corrected (TAG â†’ TAC).

`annotations/simulations/NC_000913.fna` and `annotations/simulations/NC_000913.gff` were downloaded from the corresponding ncbi genome assembly: ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/005/845/GCA_000005845.2_ASM584v2. 

## Machine Specifications

```bash
> uname -a
Linux rhino3 3.13.0-68-generic #111-Ubuntu SMP Fri Nov 6 18:17:06 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux

> lsb_release -a
No LSB modules are available.
Distributor ID:IDUbuntu
Description:DescriptionUbuntu 14.04.3 LTS
Release:Release14.04
Codename:Codenametrusty

> g++ --version
g++ (Ubuntu 4.8.4-2ubuntu1~14.04) 4.8.4
Copyright (C) 2013 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

# boost C++ library used in simulation code
> dpkg -s libboost-dev | grep 'Version'
Version: 1.54.0.1ubuntu1

> python --version
Python 2.7.6

# for running simulations on cluster
> sbatch --version
slurm 15.08.7
```
